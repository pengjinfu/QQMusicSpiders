# 某Q音乐爬虫项目

### 1. 项目概述

### 1.1  项目背景

当今社会，音乐作为一种大众娱乐形式，已经深入人们生活的方方面面。然而，各大主流音乐平台如QQ音乐、网易云音乐、酷狗音乐等，纷纷实施了付费模式。虽然付费音乐是对音乐人劳动成果的尊重，也是音乐产业发展的趋势，但对于广大音乐爱好者，尤其是学生、研究者等群体，高昂的订阅费用无疑带来了经济压力。此外，随着数字音乐版权保护意识的增强，音乐平台的反爬虫机制也日益完善，这使得获取音乐数据变得愈发困难。

做为一个音乐爱好者，我是支持付费的，本项目主要用于学习爬虫知识，逆向知识，用于研究，不作其它用图。

### 1.2 项目目标

1. **学术研究支持：** 为音乐研究、数据分析、文化研究等学术领域提供丰富、真实、全面的数据支持，促进音乐相关研究的发展，推动音乐与其他学科的交叉融合。
2. **技术探索与分享：** 通过开源项目，分享爬虫技术、Web开发经验、数据处理技巧，共同学习与进步，激发技术创新。
3. **公益性质：** 秉承开源精神，促进知识的传播与分享，让音乐触达更多人群。
4. **技术挑战：**  应对音乐平台不断升级的反爬虫机制，锻炼爬虫技术，提升问题解决能力，探索新型反反爬虫策略。
5. **数据应用拓展：** 为音乐推荐系统、音乐情感分析、音乐风格分类等数据应用提供数据基础，探索音乐数据的更多可能性。

**免责声明：** 本项目仅供个人学习、研究使用，严禁用于商业用途。请用户在遵守相关法律法规的前提下使用本项目。

**特别说明：** 本项目支持正版音乐，鼓励用户在经济条件允许的情况下，支持正版音乐，为音乐产业的发展贡献一份力量。

## 2.技术选型

### 2.1 爬虫框架/库：requests

- **优点**：
    - 简单易用：requests库提供了简洁的API，易于编写和维护爬虫代码。
    - 支持HTTP/HTTPS协议：requests支持常见的HTTP和HTTPS请求方法，适用于抓取大部分网站数据。
    - 异步支持：通过使用aiohttp等异步库，可以实现更高效的爬虫任务执行。
- **缺点**：
    - 无法处理复杂的网页解析：requests库本身不提供网页解析功能，需要结合其他库如BeautifulSoup进行处理。
    - 无法自动处理反爬虫机制：requests库无法自动处理网站的反爬虫机制，需要手动编写相关逻辑。

### 2.2 代理管理：Selenium、ProxyPool

- **Selenium**：
    - **优点**：
        - 能够模拟真实浏览器行为：Selenium能够模拟真实浏览器的行为，包括滚动、点击等操作，可以有效规避一些反爬虫机制。
        - 支持多种浏览器：Selenium支持多种浏览器，包括Chrome、Firefox、Edge等，可以适应不同网站的需求。
    - **缺点**：
        - 资源消耗较大：Selenium需要启动真实浏览器，占用较多的计算资源和内存。
        - 速度较慢：由于需要模拟真实浏览器行为，Selenium的爬取速度相对较慢。
- **ProxyPool**：
    - **优点**：
        - 动态代理池：ProxyPool可以自动获取、验证和管理代理IP，提供动态的代理池供爬虫使用，有效规避反爬虫机制。
        - 高效稳定：ProxyPool采用多线程和异步IO等技术，提供高效稳定的代理服务。
    - **缺点**：
        - 需要额外的代理IP来源：ProxyPool需要外部代理IP来源，如免费代理IP列表、付费代理IP服务等。
        - 配置和维护较复杂：ProxyPool的配置和维护相对较复杂，需要关注代理IP的质量和稳定性。

### 2.3 后端框架：Flask

- **优点**：
    - 轻量级：Flask是一个轻量级的Web框架，具有小巧、快速的特点。
    - 灵活性高：Flask提供了丰富的扩展库和插件，可以根据项目需求进行灵活配置。
    - RESTful API支持：Flask-RESTful是Flask的一个扩展库，提供了完善的RESTful API支持，方便开发和文档化。
- **缺点**：
    - 相对复杂的路由配置：Flask的路由配置相对较复杂，需要手动定义路由和视图函数的映射关系。
    - 不支持大规模并发：Flask本身不支持大规模并发请求，需要结合其他技术如Gunicorn、uWSGI等进行处理。

### 2.4 前端框架：Vue3 + Element-UI

- **Vue3**：
    - **优点**：
        - 性能优化：Vue3采用了Proxy代理、静态提升等技术，提供了更好的性能和响应速度。
        - 更简洁的API：Vue3的API更加简洁，易于理解和使用。
        - 更好的TypeScript支持：Vue3对TypeScript的支持更好，可以更方便地使用TypeScript进行开发。
    - **缺点**：
        - 学习曲线较陡峭：Vue3相对于Vue2有较大的变化，需要重新学习和适应。
        - 兼容性问题：Vue3对旧版本的浏览器和一些库可能存在兼容性问题，需要进行适配。
- **Element-UI**：
    - **优点**：
        - 美观易用：Element-UI提供了丰富的组件和样式，易于使用和定制。
        - 完善的文档和示例：Element-UI提供了详尽的文档和示例，方便开发者快速上手。
        - 社区活跃：Element-UI拥有活跃的社区，可以获取到及时的技术支持和更新。
    - **缺点**：
        - 体积较大：Element-UI的体积相对较大，需要考虑性能和加载时间。
        - 部分组件过时：Element-UI的一些组件可能已经过时，需要进行替换或升级。

### 2.5 数据库：MySQL

- **优点**：
    - 成熟稳定：MySQL是一个成熟稳定的关系型数据库，拥有广泛的应用和支持。
    - 高性能：MySQL具有高性能的特点，适用于处理大量数据和高并发请求。
    - 数据一致性：MySQL提供了ACID事务支持，保证数据的一致性和完整性。
- **缺点**：
    - 学习曲线较陡峭：MySQL的学习曲线相对较陡峭，需要掌握SQL语法和数据库设计等知识。
    - 复杂的配置和管理：MySQL的配置和管理相对复杂，需要关注性能调优、备份和恢复等方面。
    - 需要定期维护：MySQL需要定期进行数据备份、优化和升级等维护工作，以保证数据库的稳定性和安全性。

### 2.6 API文档工具：Swagger

- 优点
    - 自动生成API文档：Swagger可以根据定义的API接口自动生成详尽的API文档，包括接口描述、参数、返回值等信息，方便开发者和用户了解和使用接口。
    - 可视化界面：Swagger提供了可视化的界面，可以直观地查看和测试API接口，提高开发效率和用户体验。
    - 集成度高：Swagger可以与各种后端框架和开发工具集成，如Flask、Django、Spring等，方便开发者在开发过程中使用。
- 缺点
    - 配置较为复杂：Swagger的配置相对较为复杂，需要定义接口的详细信息和规范，需要一定的学习和实践经验。
    - 依赖性较高：Swagger依赖于一些第三方库和工具，如JAX-RS、Spring MVC等，需要确保这些依赖项的版本兼容性。
    - 功能较为基础：Swagger提供的功能相对较为基础，对于一些高级的API文档需求，可能需要额外的定制和

## 3. 功能需求

### 3.1 爬虫功能

## 3.1 爬虫功能

#### 3.1.1 抓取内容：

##### 3.1.1.1 **首页数据**：

- 首页链接:首页顶部链接，首页导航栏链接，首页底部链接，其它链接

    - 链接名称
    - 链接网址

- 首页歌单推荐

    - 歌曲名称
    - 歌曲图片
    - 播放量
    - 歌曲链接

- 新歌首发

    - 歌曲名称
    - 歌曲图片
    - 歌曲时常
    - 歌曲链接
    - 歌手

- 新碟首发

    - id
    - mid
    - name
    - singers
        - id
        - mid
        - name

- 排行榜

    - 排行榜类行
    - 排行榜信息

- 精彩推荐

    - id
    - subid
    - title
    - cover
    - tjreport
    - miscellany
    - style

- MV

    - mv图片
    - 歌手信息
    - mv标题
    - mv id

- 搜索排行榜:歌曲，歌手，资讯

    - 描述：正在搜索

    - 搜索词

    - 搜索来源

    - 评分

    - 搜索标题

    - 歌曲图片

    - 歌曲搜索id

##### 3.1.1.2 **首页搜索**：

- 搜索歌曲：歌曲、专辑、MV等
    - 专辑信息
    - mv信息
    - 单曲信息
- 搜索歌手
    - 专辑信息
    - mv信息
    - 单曲信息
    - 歌手信息
- 搜索用户
    - 未发现有此数据

##### 3.1.1.3 **歌手**：

- 歌手列表
- 歌手详细信息
- 歌手全部歌曲

##### 3.1.1.4 **歌曲**：

- 歌曲信息
- 歌曲评论
- 歌曲MV
- 歌曲歌词
- 歌曲MP3文件
- 下载歌曲文件

##### 3.1.1.5 排行榜

* 排行榜分类
    * 巅峰榜
        * 飙升榜：https://y.qq.com/n/ryqq/toplist/62
        * 热歌榜：https://y.qq.com/n/ryqq/toplist/26
        * 新歌榜：https://y.qq.com/n/ryqq/toplist/27
        * 流行指数榜：https://y.qq.com/n/ryqq/toplist/4
        * 腾讯音乐人原创榜：https://y.qq.com/n/ryqq/toplist/52
        * 听歌识曲榜：https://y.qq.com/n/ryqq/toplist/67
        * MV榜：https://y.qq.com/n/ryqq/toplist/mv_toplist
            * mainland：内陆
            * hktw：港台
            * euus：欧美
            * kr:韩国
            * jp:日本
    * 地区榜
        * 内地榜：https://y.qq.com/n/ryqq/toplist/5
        * 香港地区榜：https://y.qq.com/n/ryqq/toplist/59
        * 台湾地区榜：https://y.qq.com/n/ryqq/toplist/61
        * 欧美榜：https://y.qq.com/n/ryqq/toplist/3
        * 韩国榜：https://y.qq.com/n/ryqq/toplist/16
        * 日本榜：https://y.qq.com/n/ryqq/toplist/17
        * JOOX本地热播榜：https://y.qq.com/n/ryqq/toplist/126
        * 香港TVB劲歌金榜：https://y.qq.com/n/ryqq/toplist/130
        * 台湾KKBOX榜：https://y.qq.com/n/ryqq/toplist/127
* 排行榜分类信息
* 排行榜评论

#### 3.1.2 反爬虫处理：

1. **数据反爬虫**：使用JS逆向技术处理动态加载的数据。
2. **请求体反爬虫**：使用JS逆向技术处理请求体中的加密数据。
3. **Cookie反爬虫**：模拟登录获取Cookie，使用代理服务器规避反爬虫机制。

#### 3.1.3 抓取效率：

1. **单进程**：基于传统的单线程爬虫。
2. **多进程**：使用多进程并发抓取数据。
3. **aiohttp库**：使用异步IO库aiohttp进行异步抓取。
4. **多线程**：使用多线程并发抓取数据。
5. **协程**：使用协程实现高效的异步抓取。

#### 3.1.4 异常处理：

1. **数据静态缓存**：将抓取到的数据进行缓存，避免重复抓取。
2. **请求异常处理**：处理网络异常、服务器异常等请求异常情况。
3. **抓取频率处理**：根据服务器的限制，合理控制抓取频率，避免被封禁。

#### 3.1.4 数据抓取分析：

1. **数据静态化**：将抓取到的数据进行静态化处理，方便后续分析和展示。
2. **数据保存到MySQL**：将抓取到的数据保存到MySQL数据库中，方便后续查询和分析。
3. **定时任务处理**：使用定时任务来定期抓取最新的数据，保持数据的实时性。

### 3.2 Web 前端功能

* **搜索界面:** 提供搜索框，用户可以输入歌曲名、歌手、专辑等信息进行搜索。
* **歌曲列表展示:** 展示搜索到的歌曲列表，包括歌曲名、歌手、专辑、时长等信息。
* **歌曲下载:** 提供歌曲下载按钮，用户可以选择音质进行下载。
* **歌词展示:**  展示歌曲的歌词，并提供复制功能。
* **专辑信息展示:**  展示专辑信息，包括专辑名、歌手、封面、歌曲列表等。
* **歌手信息展示:** 展示歌手信息，包括歌手名、简介、专辑列表等。
* **用户管理:** 用户可以注册、登录，并管理自己的下载记录。

### 3.3 其他功能

* **数据存储:** 使用数据库存储爬取到的歌曲信息，方便用户管理和检索。
* **日志记录:** 记录爬虫运行状态和错误信息，方便排查问题。
* **安全机制:**  防止爬虫被封禁，并保护用户隐私。
### 4. 系统架构

#### 4.1 系统架构图

![系统架构图](架构图.png)

#### 4.2 模块划分

* **爬虫模块:** 负责爬取 QQ音乐数据，包括歌曲信息、歌词、专辑信息、歌手信息等。
* **代理池模块:** 负责管理代理服务器，提供代理 IP 和端口信息给爬虫模块。
* **数据库模块:** 负责存储爬取到的数据，并提供数据查询和管理功能。
* **API 模块:** 基于 Flask-RESTful 构建 RESTful API，提供前端访问数据接口。
* **前端模块:** 基于 Vue3 + ElementUI 构建 Web 前端界面，提供用户交互功能。

### 5. 开发流程

* **需求分析与设计:** 确定项目需求，设计系统架构和模块划分。
* **爬虫模块开发:** 开发爬虫代码，实现歌曲搜索、下载、歌词获取、专辑信息获取、歌手信息获取等功能。
* **代理池模块开发:** 开发代理池模块，提供代理 IP 和端口信息给爬虫模块。
* **数据库模块开发:** 开发数据库模块，存储爬取到的数据，并提供数据查询和管理功能。
* **API 模块开发:** 开发 API 模块，提供前端访问数据接口。
* **前端模块开发:** 开发前端界面，实现用户搜索、下载、管理等功能。
* **测试与部署:** 对系统进行测试，并部署到服务器上。

### 6.  项目进度

| 阶段 | 任务           | 预计时间 |
| ---- | -------------- | -------- |
| 1    | 需求分析与设计 | 1 周     |
| 2    | 爬虫模块开发   | 2 周     |
| 3    | 代理池模块开发 | 1 周     |
| 4    | 数据库模块开发 | 1 周     |
| 5    | API 模块开发   | 1 周     |
| 6    | 前端模块开发   | 2 周     |
| 7    | 测试与部署     | 1 周     |

### 7. 项目成员

* **项目负责人:** [姓名]
* **爬虫开发:** [姓名]
* **代理池开发:** [姓名]
* **数据库开发:** [姓名]
* **API 开发:** [姓名]
* **前端开发:** [姓名]

### 8. 联系方式

* **项目负责人邮箱:** [邮箱地址]

### 9. 附录

* **数据库设计文档**
* **代码规范文档**
* **测试用例文档**

**注:**  本需求文档仅供参考，具体细节需要根据实际情况进行调整。

